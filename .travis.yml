sudo: false

language: php

php:
    - 5.3
    - 5.4
    - 5.5
    - 5.6
    - 7
    - hhvm

matrix:
    allow_failures:
        - php: hhvm

branches:
  only:
    - master

env:
  global:
    # Pantheon site UUID
    - PUUID='094f4627-a25e-4d60-8d5b-a3d99a7232bf'

    # Pantheon site name
    - PSITE='Pantheon WP Best Practices'

    # Pantheon environment
    # Where we deploy to if the build passes
    - PENV='dev'

install:
  # Dynamic hosts through Pantheon mean constantly checking interactively
  # that we mean to connect to an unknown host. We ignore those here.
  - echo Disabling strict host checking
  - echo "StrictHostKeyChecking no" > ~/.ssh/config

before_script:
    - composer self-update
    - composer install --no-ansi --no-dev --no-interaction --no-scripts --optimize-autoloader --prefer-source
    - git config --global user.email "andrew@ataylor.me"
    - git config --global user.name "ataylorme"

after_script:
    - cd $TRAVIS_BUILD_DIR
    - rsync -a $TRAVIS_BUILD_DIR/vendor/pantheon-systems/WordPress/* $TRAVIS_BUILD_DIR/public/
    - cd $TRAVIS_BUILD_DIR/public

script:
    - return 1

deploy:
